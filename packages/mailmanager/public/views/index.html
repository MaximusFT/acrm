<div ng-app="mailmanager">
  <div data-ng-controller="MailmanagerController">
    <h1>Mail Manager</h1>
    <div class="panel panel-default">
      <div class="panel-heading">Control panel</div>
      <div class="panel-body" >
        <div class="row">
          <div class="col-md-8">
            <div class="btn-group" dropdown>
              <button type="button" class="btn btn-warning dropdown-toggle" dropdown-toggle data-ng-disabled="isSomeSelected" data-ng-click="assignToPerson()">Assign to person</button>
            </div>
            <div class="btn-group" style="padding: 10px;">
              <input type="button" class="btn btn-danger" value="Remove selected" data-ng-disabled="isSomeSelected" data-ng-click="remove()"></div>
            <div class="btn-group">
              <input type="button" class="btn btn-primary" value="Revoke selected" data-ng-disabled="isSomeSelected" data-ng-click="revoke()"></div>
            <input type="text" style="padding: 5px; margin-left: 12px" placeholder="Search" ng-model="search"></div>
          <p style="float:right; padding:10px">
            <button type="button" data-ng-click="configModal()" class="btn btn-primary btn-lg">Settings</button>
          </p>
        </div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">All Mailboxes</div>
      <div class="panel-body" >
        <accordion close-others="oneAtATime" data-ng-init="getMailboxes()">
          <accordion-group heading="{{mailbox.domain}}" data-ng-repeat="mailbox in mailboxes | filter:search" data-ng-init="sectionIndex=$index">
            <div class="panel-body" cg-busy="{promise:wait,message:'Loading. Please wait...',backdrop:false,delay:300,minDuration:700}">
              <table class="table table-striped table-bordered table-hover editable-table" >
                <tbody>
                  <tr>
                    <th> <i class="glyphicon glyphicon-sort-by-order"></i>
                    </th>
                    <th> <i class="glyphicon glyphicon-ok" data-ng-click="selectAll(sectionIndex)"></i>
                    </th>
                    <th>MailBox</th>
                    <th><a data-ng-click="sortbyfield(sectionIndex,'quota')">Quota<span style="margin-left: 5px;" class="glyphicon glyphicon-sort-by-order-alt"></span></a></th>
                    <th><a data-ng-click="sortbyfield(sectionIndex,'messages')">Messages<span style="margin-left: 5px;" class="glyphicon glyphicon-sort-by-order-alt"></span></a></th>
                    <th>State</th>
                    <th>Action</th>
                  </tr>
                </tbody>
                <tr data-ng-repeat="box in mailbox.data" class="ng-scope">
                  <td>
                    {{$index+1}}
                  </td>
                  <td>
                    <input type="checkbox" data-ng-model="box.Selected" data-ng-click="checkMail(sectionIndex, $index, box)"></td>
                  <td>{{box.mail}}</td>
                   <td><progressbar class="progress-striped active" value="box.quota" type="success"><b style="color:black">{{box.quota}}%</b></progressbar></td>
                   <td class="text-center"><b>{{box.messages}}</b></td>
                   <td> <span class="btn col-xs-12 {{box.state == 1 ? 'btn-success' : 'btn-danger'}}" style="pointer-events:none">{{box.state == 1 ? 'Active' : 'Disabled' }}</span></td>
                  <td>
                   <a class="btn btn-primary col-xs-12" type="button" style="pointer-events: {{box.state==0?'none': ''}};" href="#!/mailmanager/{{box.mail}}" target="_blank">Login</a>
                  </td>
                </tr>
              </table>
            </div>
          </accordion-group>
        </accordion>
        <p><b>Total: {{mailboxes.length}}</b></p>
      </div>
    </div>
  </div>
</div>