<div class="" data-ng-controller="ServermanagerController">
    <h1>Server Infrastructure</h1>
    <br />
    <div class="row">
        <div class="col-md-3" data-ng-init="init()" cg-busy="{promise:getHttp1,message:'Loading. Please wait...',backdrop:false,delay:300,minDuration:700}">
            <legend>Servers</legend>
            <div class="input-group">
                <span type="button" class="input-group-addon" style="cursor:pointer;" data-ng-click="addServer()" popover="Add new server" popover-trigger="mouseenter"> <i class="glyphicon glyphicon-plus"></i>
                </span>
                <input type="text" class="form-control" data-ng-model="search" placeholder="Search" />
            </div>
            <br />
            <ul class="nav nav-pills nav-stacked" data-ng-repeat="server in servers | filter:search" data-ng-if="servers.length">
                <li role="presentation">
                    <span style="line-height:3;">
                        <a href="" data-ng-click="selectServer(server, $index)">
                            <span style="font-family:monospace;"> <i class="glyphicon glyphicon-hdd"></i>
                                &nbsp;{{server.ip}}
                            </span>
                        </a>
                        <button type="button" class="btn btn-xs btn-danger" style="float:right;margin-top:9px;" data-ng-click="removeServer(server, $index)" data-ng-show="isVisibleRemoveButton[$index] === true">
                            <i class="glyphicon glyphicon-remove"></i>
                        </button>
                    </span>
                </li>
            </ul>
            <alert type="info" data-ng-if="!servers || !servers.length">No servers</alert>
        </div>
        <div class="col-md-9">
            <legend>Information</legend>
            <div data-ng-if="!selectedServer">
                <p>Choose server.</p>
            </div>
            <div cg-busy="{promise:getHttp2,message:'Loading. Please wait...',backdrop:false,delay:300,minDuration:700}" data-ng-if="selectedServer">
                <div style="float:right;">
                    <input type="button" class="btn btn-warning btn-sm" value="Edit" data-ng-click="editServer(selectedServer)" />
                </div>
                <p style="font-size:20px;text-align:center;font-weight:bolder;">{{selectedServer.ip}}</p>
                <p data-ng-if="selectedServer.ips && selectedServer.ips.length" style="display:inline-flex;"> <strong style="float:left;">Other IPs:</strong>
                    &nbsp;
                    <span data-ng-repeat="ip in selectedServer.ips">
                        <a href="#" class="tag">{{ip}}</a>
                    </span>
                </p>
                <p> <strong>Location:</strong>
                    {{selectedServer.location}}
                </p>
                <p>
                    <strong>Type:</strong>
                    {{selectedServer.type === 0 ? 'Physical Server' : 'VPS/VDS'}}
                </p>
                <div cg-busy="{promise:getHttp2,message:'Loading. Please wait...',backdrop:false,delay:300,minDuration:700}">
                    <br />
                    <legend>
                        Deployed sites
                        <i class="glyphicon glyphicon-plus" style="float:right;cursor:pointer;" data-ng-click="addSite()"></i>
                    </legend>
                    <alert type="info" data-ng-if="!deployedSites.length">No sites yet</alert>
                    <br />
                    <div data-ng-if="deployedSites.length">
                        <div style="float:right;">
                            <label for="irm1">Remove mode</label>
                            <input id="irm1" type="checkbox" class="btn" data-ng-model="removeMode" />
                        </div>
                        <table class="table table-striped table-bordered table-hover editable-table">
                            <tr>
                                <th>
                                    <i class="glyphicon glyphicon-sort-by-order-alt"></i>
                                </th>
                                <th>Title</th>
                                <th>URI</th>
                                <th>Go</th>
                                <th>IP</th>
                                <th>Comment</th>
                                <th data-ng-show="removeMode">
                                    <i class="glyphicon glyphicon-trash"></i>
                                </th>
                            </tr>
                            <tr data-ng-repeat="site in deployedSites">
                                <td>
                                    <a href="/#!/servers/site/{{site._id}}">{{$index+1}}.</a>
                                </td>
                                <td class="table-editable-cell">
                                    <span class="editable-span" data-ng-editable="updateSite(site, 'title')" data-ng-editable-model="site.title"></span>
                                </td>
                                <td class="table-editable-cell">
                                    <span class="editable-span" data-ng-editable="updateSite(site, 'uri')" data-ng-editable-model="site.uri"></span>
                                </td>
                                <td>
                                    <a href="{{site.uri}}" target="_blank">link</a>
                                </td>
                                <td class="table-editable-cell">
                                    <span class="editable-span" data-ng-editable="updateSite(site, 'ip')" data-ng-editable-model="site.ip"></span>
                                </td>
                                <td class="table-editable-cell">
                                    <span class="editable-span" data-ng-editable="updateSite(site, 'comment')" data-ng-editable-model="site.comment"></span>
                                </td>
                                <td data-ng-show="removeMode" style="text-align:center;">
                                    <input class="btn btn-danger btn-xs" type="button" value="Remove" data-ng-click="removeSite(site, $index)" />
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>