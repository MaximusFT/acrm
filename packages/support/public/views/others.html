<tabset>
  <tab select="myOpenedTickets()">
    <tab-heading>
      <i class="glyphicon glyphicon-retweet">
      </i>
      Your tickets
    </tab-heading>
	<div cg-busy="{promise:getHttp1,message:'Loading. Please wait...',backdrop:false,delay:300,minDuration:700}">
		<h3>{{onlyMyOpened ? 'Opened tickets' : 'All tickets'}}<i class="glyphicon glyphicon-lock" style="cursor:pointer;float:right;color:{{onlyMyOpened ? '#000000' : '#0000FF'}}" data-ng-click="changeOnlyMyOpened(tab.type)"></i></h3>
		<br />
		<accordion close-others="true">
		<div data-ng-repeat="ticket in tickets" data-ng-init="ticketIndex = $index">
			<accordion-group is-open="isTicketOpen[$index]" heading="Ticket #{{ticket._id}}">
			<div class="panel {{ticket.status === 0 ? 'panel-info' : 'panel-success'}}">
				<div class="panel-heading">
					{{ticket.subject}} | {{ticket.status === 0 ? 'Opened' : 'Closed'}} {{ticket.status === 0 ? formatDate(ticket.when_opened) : formatDate(ticket.when_closed)}} <i data-ng-click="refreshTicket(ticketIndex)" style="float:right;cursor:pointer;" data-ng-class="ticket.isRefreshing === true ? 'glyphicon glyphicon-time' : 'glyphicon glyphicon-refresh'" data-ng-disabled="ticket.status === 1"></i>
				</div>
				<div class="panel-body">
					<ul class="media-list">
						<li class="media" data-ng-repeat="msg in ticket.correspondence">
							<div class="media-body">
                                <div class="media">
                                    <div class="pull-left">
                                        <img data-ng-if="msg.role==='a'" class="media-object img-circle " src="support/assets/img/admin.png" />
										<img data-ng-if="msg.role==='u'" class="media-object img-circle " src="support/assets/img/user.png" />
									</div>
									<div class="media-body">
										{{msg.text}}
										<br />
										<p><small class="text-muted">{{msg.role==='a' ? 'Admin' : ticket.from.name}} | {{formatDate(msg.when)}}</small></p>
										<hr />
									</div>
								</div>
							</div>
                        </li>
                    </ul>
				</div>
				<div class="panel-footer">
					<form data-ng-submit="reply(ticketIndex, answer); answer=''">
					<div class="input-group">
						<span class="input-group-addon" style="cursor:pointer;" data-ng-click="refreshTicket(ticketIndex)"><i style="float:right;" data-ng-class="ticket.isRefreshing === true ? 'glyphicon glyphicon-time' : 'glyphicon glyphicon-refresh'"></i></span>
                        <input type="text" class="form-control" placeholder="Enter Message" data-ng-model="answer" />
                        <span class="input-group-btn">
                            <button class="btn btn-info" type="submit">SEND</button>
                        </span>
                    </div>
					</form>
				</div>
			</div>
			</accordion-group>
		</div>
		</accordion>
		<div data-ng-if="!isTickets">
			<br \>
			<p class='bg-warning'>
				There are no unprocessed requests.
			</p>
		</div>
	</div>
  </tab>
  <tab>
	<tab-heading>
      <i class="glyphicon glyphicon-send">
      </i>
      Create new ticket
    </tab-heading>
	<br />

	<div class="panel panel-default">
      <div class="panel-heading">
        You can suggest an idea or request access here.
      </div>
	  
      <div class="panel-body">
        <div class="row">
          <div class="col-md-6">
            <div class="btn-group" style="padding: 10px;">             
              <input type="button" style="margin-rightL:5px;" class="btn btn-success" value="Suggest an idea" data-ng-click="isCollapsed1=true;isCollapsed2=false;">
			  <input type="button" style="margin-left:5px;" class="btn btn-info" value="Submit a request" data-ng-click="isCollapsed2=true;isCollapsed1=false;">
            </div>			
          </div>	  
        </div>
      </div>
	</div>
	   
	<div collapse="!isCollapsed1">
	<div class="panel panel-success" data-ng-hide="isSentIdea">
	<div class="panel-heading">
        Please describe your idea here. We are very grateful for your feedback.
    </div>
	<div class="panel-body">
		<form class="form-horizontal" role="form" data-ng-submit="openTicket(idea, 1);">
			<div class="form-group">
				<label for="subject" class="col-sm-2 control-label">Subject</label>
				<div class="col-sm-10">
					<input type="text" class="form-control" id="subject" placeholder="Theme" data-ng-model="idea.subject" required>
				</div>
			</div>
			<div class="form-group">
				<label for="idea" class="col-sm-2 control-label">Your idea</label>
				<div class="col-sm-10">
					<textarea class="form-control" id="idea" placeholder="Your idea" rows="4" data-ng-model="idea.text" required></textarea>
				</div>
			</div>
			<div class="form-group">
				<div class="col-sm-offset-2 col-sm-10">
					<button type="submit" class="btn btn-success" style="float:right;width: 200px;">Send</button>
				</div>
			</div>
		</form>		
	</div>
	</div>
	<div data-ng-show="isSentIdea">
		<alert type="success" close="isSentIdea=false">The idea was successfully sent!</alert>
	</div>
	</div>
	<div collapse="!isCollapsed2">
	<div class="panel panel-primary" data-ng-hide="isSentRequest">
	<div class="panel-heading">
        If you need access to any corporate resource, you can request it through this form.
    </div>
	<div class="panel-body">
		<form class="form-horizontal" role="form" data-ng-submit="openTicket(req, 0);">
			<div class="form-group">
				<label for="subject" class="col-sm-2 control-label">Subject</label>
				<div class="col-sm-10">
					<input type="text" class="form-control" id="subject" placeholder="Theme" data-ng-model="req.subject" required>
				</div>
			</div>
			<div class="form-group">
				<label for="request" class="col-sm-2 control-label">Your request</label>
				<div class="col-sm-10">
					<textarea class="form-control" id="request" placeholder="Your request" rows="4" data-ng-model="req.text" required></textarea>
				</div>
			</div>
			<div class="form-group">
				<div class="col-sm-offset-2 col-sm-10">
					<button type="submit" class="btn btn-primary" style="float:right;width: 200px;">Send</button>
				</div>
			</div>
		</form>		
	</div>
	</div>
	<div data-ng-show="isSentRequest">
		<alert type="info" close="isSentRequest=false">The request was successfully sent!</alert>
	</div>
	</div>
  </tab>