<section data-ng-controller="UsersController">
	<div class="panel panel-default">
	<div class="panel-heading">Adding new users</div>
	<div class="panel-body">
    <form id="pass-add-form" class="row-fluid form-inline" name="addUserForm" data-ng-submit="add()">
        <div class="row">
			<div class="col-md-8">
            <span data-ng-repeat="field in userSchema">
                <input data-ng-if="(field['type'] == 'text' || field['type'] == 'password')" type="{{field['type']}}" class="span2" data-ng-model="user[field['schemaKey']]" placeholder="{{field['title']}}" id="user-add-title" />
                <select class="form-control" data-ng-if="field['type'] == 'select'" data-ng-model="user[field['schemaKey']]" ng-multiple="true" multiple ng-options="option for option in field['options']">
                    <option value="">-- Choose Role --</option>
                </select>
            </span>
			</div>
			<div class="col-md-4">
            <input type="submit" class="btn span1" value="Add" />
			<div class="loader" data-ng-init="init()" data-ng-hide="departments.length"></div>
			<div class="btn-department" style="padding: 10px;" data-ng-show="departments.length">
				<input type="button" class="btn btn-danger" data-ng-hide="edit" data-ng-click="edit=!edit" value="Enable edit mode">
				<input type="button" class="btn btn-primary" data-ng-show="edit" data-ng-click="edit=!edit" value="Disable edit mode">
			</div>
			<input type="text" style="padding: 5px; margin-left: 12px" placeholder="Search" ng-model="search">
			</div>
        </div>
    </form>
	</div>
	</div>
	
	<div data-ng-repeat="department in departments">
	<h1 data-ng-show="department.users.length">{{department.department}}</h1>
    <table class="table table-striped table-bordered table-hover editable-table" data-ng-show="department.users.length">
        <tr>
            <th data-ng-show="edit">
                Edit
            </th>
			<th>
                #
            </th>
            <th data-ng-repeat="field in userSchema" data-ng-if="field.inTable">{{field.title}}</th>
        </tr>
        <tr data-ng-repeat="user in department.users | filter:search:strict">
            <td data-ng-show="edit">
                <button class="glyphicon glyphicon-trash" data-ng-click="remove(user)" value="del">
                    <i class="icon-trash icon-white"></i>
                </button>
            </td>
			<td>
                <a href="#!/manager/users/{{user['username']}}">#</a>
            </td>
            <td class="table-editable-cell" data-ng-repeat="field in userSchema" data-ng-if="field.inTable">
				<div data-ng-if="mode === 'Administrator'">
					<span data-ng-click="beforeSelect(field['schemaKey'], user)" data-ng-if="(field['type'] == 'text')" class="editable-span" data-ng-editable="update(user, field['schemaKey'])" data-ng-editable-model="user[field['schemaKey']]"></span>
					<span data-ng-click="beforeSelect(field['schemaKey'], user)" data-ng-if="(field['type'] == 'select')" class="editable-span" data-ng-editable-select="update(user, field['schemaKey'])" data-ng-editable-select-model="user[field['schemaKey']]" data-ng-editable-select-options="field['options']"></span>
				</div>
				<div data-ng-if="mode === 'Manager'">
					<span data-ng-click="beforeSelect(field['schemaKey'], user)" data-ng-if="(field['type'] == 'text') && field['schemaKey'] !== 'email' && field['schemaKey'] !== 'username'" class="editable-span" data-ng-editable="update(user, field['schemaKey'])" data-ng-editable-model="user[field['schemaKey']]"></span>
					<span data-ng-click="beforeSelect(field['schemaKey'], user)" data-ng-if="(field['type'] == 'select' && field['schemaKey'] === 'roles')" class="editable-span" data-ng-editable-select="update(user, field['schemaKey'])" data-ng-editable-select-model="user[field['schemaKey']]" data-ng-editable-select-options="field['options']"></span>
					<span data-ng-if="(field['type'] == 'select' && field['schemaKey'] === 'department') || field['schemaKey'] === 'email' || field['schemaKey'] === 'username'">{{user[field['schemaKey']]}}</span>
				</div>
				<div data-ng-if="mode === 'Employeer'">
					<span>{{user[field['schemaKey']]}}</span>
				</div>
            </td>
        </tr>
    </table>
	<!--</div>
	<div data-ng-if="mode == 1">Manager View
	</div>
	<div data-ng-if="mode == 2">Employeer</div>
	<div data-ng-if="mode == 3">Simply authenticated</div>-->
</section>